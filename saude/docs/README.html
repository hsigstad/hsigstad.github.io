<!DOCTYPE html>
<html lang="en">
<head>
<meta name="robots" content="noindex, nofollow">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Project Overview — Judicialização da Saúde</title>
<style>
  :root {
    --bg: #f8f9fa; --card: #fff; --fg: #1a1a1a; --muted: #666;
    --border: #dee2e6; --accent: #0d6efd; --accent2: #198754;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background: var(--bg); color: var(--fg); line-height: 1.5;
  }

  main {
    padding: 1.5rem 2rem 3rem; max-width: 900px; margin: 0 auto;
  }

  /* Markdown body styles */
  .md-body { font-size: .92rem; line-height: 1.7; color: #1f2328; }

  .md-body h1 { font-size: 1.5rem; font-weight: 600; margin: 1.8rem 0 .8rem; padding-bottom: .3rem; border-bottom: 1px solid var(--border); }
  .md-body h2 { font-size: 1.25rem; font-weight: 600; margin: 1.6rem 0 .6rem; padding-bottom: .25rem; border-bottom: 1px solid var(--border); }
  .md-body h3 { font-size: 1.05rem; font-weight: 600; margin: 1.3rem 0 .5rem; }
  .md-body h4 { font-size: .95rem; font-weight: 600; margin: 1.1rem 0 .4rem; }
  .md-body h5, .md-body h6 { font-size: .88rem; font-weight: 600; margin: 1rem 0 .4rem; }
  .md-body h1:first-child { margin-top: 0; }

  .md-body p { margin: 0 0 .8rem; }

  .md-body ul, .md-body ol { margin: 0 0 .8rem; padding-left: 1.8rem; }
  .md-body li { margin-bottom: .25rem; }
  .md-body li > ul, .md-body li > ol { margin-top: .25rem; margin-bottom: 0; }

  /* Task lists */
  .md-body ul li { list-style: disc; }
  .md-body li input[type="checkbox"] {
    margin-right: .4rem; vertical-align: middle; position: relative; top: -1px;
  }

  .md-body a { color: var(--accent); text-decoration: none; }
  .md-body a:hover { text-decoration: underline; }

  .md-body strong { font-weight: 600; }

  .md-body blockquote {
    margin: 0 0 .8rem; padding: .4rem 1rem;
    border-left: 4px solid var(--accent); background: #f0f4f8;
    color: #555; font-size: .88rem;
  }
  .md-body blockquote p:last-child { margin-bottom: 0; }

  .md-body code {
    font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
    font-size: .85em; background: #eef1f5; padding: .15rem .35rem;
    border-radius: 4px;
  }
  .md-body pre {
    margin: 0 0 .8rem; padding: .9rem 1rem;
    background: #f6f8fa; border: 1px solid var(--border);
    border-radius: 6px; overflow-x: auto; line-height: 1.45;
  }
  .md-body pre code {
    background: none; padding: 0; font-size: .82rem;
  }

  .md-body table {
    width: 100%; border-collapse: collapse; margin: 0 0 .8rem;
    font-size: .85rem; display: block; overflow-x: auto;
  }
  .md-body th, .md-body td {
    padding: .45rem .7rem; border: 1px solid var(--border); text-align: left;
  }
  .md-body th { background: #f0f4f8; font-weight: 600; }
  .md-body tr:nth-child(even) td { background: #fafbfc; }

  .md-body hr {
    border: none; border-top: 1px solid var(--border); margin: 1.5rem 0;
  }

  .md-body img { max-width: 100%; }

  /* Collapsible sections */
  .doc-controls { margin-bottom: 1rem; }
  .doc-controls button {
    font-size: .8rem; padding: .3rem .7rem; cursor: pointer;
    background: var(--card); border: 1px solid var(--border); border-radius: 4px;
    color: var(--accent); font-weight: 600;
  }
  .doc-controls button:hover { background: #e7f1ff; }
  .md-body details { margin-bottom: .5rem; }
  .md-body details summary {
    font-weight: 600; cursor: pointer; list-style: none;
  }
  .md-body details summary::-webkit-details-marker { display: none; }
  .md-body details summary::before {
    content: "\25b6"; font-size: .7em; margin-right: .5rem;
    display: inline-block; transition: transform .15s;
  }
  .md-body details[open] summary::before { transform: rotate(90deg); }
  .md-body details.level-2 > summary {
    font-size: 1.25rem; padding-bottom: .25rem;
    border-bottom: 1px solid var(--border); margin: 1.6rem 0 .6rem;
  }
  .md-body details.level-3 > summary {
    font-size: 1.05rem; margin: 1.3rem 0 .5rem;
  }

  footer {
    text-align: center; padding: 1.5rem; font-size: .8rem; color: var(--muted);
    border-top: 1px solid var(--border); margin-top: 2rem;
  }
</style>
</head>
<body>

<style>
  .site-nav {
    position: sticky; top: 0; z-index: 100;
    background: #212529; display: flex; align-items: center;
    padding: 0 2rem; height: 3rem;
  }
  .site-nav .nav-brand {
    color: #fff; text-decoration: none; font-weight: 600; font-size: 1rem;
    margin-right: auto;
  }
  .site-nav .nav-brand:hover { color: #e9ecef; }
  .site-nav .nav-link {
    color: #adb5bd; text-decoration: none; font-size: .85rem;
    padding: 0 .75rem; height: 3rem; display: flex; align-items: center;
    background: none; border: none; cursor: pointer; font-family: inherit;
  }
  .site-nav .nav-link:hover, .site-nav .nav-link.active { color: #fff; }
  .nav-dropdown { position: relative; }
  .dropdown-menu {
    display: none; position: absolute; top: 3rem; right: 0;
    background: #fff; border: 1px solid var(--border); border-radius: 6px;
    box-shadow: 0 4px 16px rgba(0,0,0,.12); min-width: 220px;
    padding: .4rem 0; z-index: 200; max-height: 80vh; overflow-y: auto;
  }
  .nav-dropdown.open .dropdown-menu { display: block; }
  .dropdown-menu a {
    display: block; padding: .3rem 1rem; color: #1a1a1a;
    text-decoration: none; font-size: .82rem;
  }
  .dropdown-menu a:hover { background: #f0f4f8; }
  .dropdown-group-label {
    padding: .4rem 1rem .15rem; font-size: .68rem; font-weight: 700;
    color: #888; text-transform: uppercase; letter-spacing: .04em;
  }
  .dropdown-divider { border-top: 1px solid #eee; margin: .3rem 0; }
  .page-header {
    padding: .8rem 2rem; border-bottom: 1px solid var(--border); background: #fff;
  }
  .page-header h1 { font-size: 1.3rem; font-weight: 600; }
  .page-header p { color: var(--muted); font-size: .85rem; margin-top: .15rem; }
</style>

<nav class="site-nav">
  <a href="../index.html" class="nav-brand">Judicialização da Saúde</a>
  <a href="../paper/index.html" class="nav-link">Paper</a>
  <div class="nav-dropdown">
    <button class="nav-link active">Docs &#9662;</button>
    <div class="dropdown-menu">
    <div class="dropdown-group-label">Research reference</div>
    <a href="../docs/README.html">Project Overview</a>
    <a href="../docs/summary.html">Research Summary</a>
    <a href="../docs/institutions.html">Institutional Background</a>
    <a href="../docs/data.html">Data Sources</a>
    <a href="../docs/methods.html">Empirical Methods</a>
    <a href="../docs/literature.html">Literature</a>
    <a href="../docs/theory.html">Theoretical Framework</a>
    <a href="../docs/hypotheses.html">Hypotheses & Evidence</a>
    <div class="dropdown-divider"></div>
    <div class="dropdown-group-label">Working notes</div>
    <a href="../docs/thinking.html">Open Questions & Ideas</a>
    <a href="../docs/decisions.html">Key Decisions</a>
    <a href="../docs/qa.html">Research Q&A</a>
    <div class="dropdown-divider"></div>
    <div class="dropdown-group-label">Task tracking</div>
    <a href="../docs/todo.html">Active Tasks</a>
    <a href="../docs/done.html">Completed Tasks</a>
    <div class="dropdown-divider"></div>
    <div class="dropdown-group-label">Communication</div>
    <a href="../docs/meetings.html">Meeting Notes</a>
    <a href="../docs/feedback.html">External Feedback</a>
    <div class="dropdown-divider"></div>
    <div class="dropdown-group-label">Court analysis</div>
    <a href="../docs/01-stf-reasoning-templates.html">STF Reasoning Templates</a>
    <a href="../docs/02-stj-repetitivos-patterns.html">STJ Repetitivos Patterns</a>
    <a href="../docs/03-tjsp-plans-vs-sus.html">TJSP: Plans vs SUS</a>
    <a href="../docs/04-conitec-pcdt-vs-courts.html">CONITEC vs Courts</a>
    <a href="../docs/05-interfederative-responsibility.html">Interfederative Responsibility</a>
    </div>
  </div>
  <div class="nav-dropdown">
    <button class="nav-link">Data &#9662;</button>
    <div class="dropdown-menu">
    <a href="../sources/tjsp.html">TJSP</a>
    <a href="../sources/datajud.html">DataJud</a>
    <a href="../sources/stf-stj.html">STF & STJ</a>
    <a href="../sources/trf3.html">TRF3</a>
    <a href="../sources/spending.html">Municipal Spending</a>
    <a href="../sources/legislation.html">Health Legislation</a>
    </div>
  </div>
  <a href="../references/index.html" class="nav-link">References</a>
  <a href="../news/index.html" class="nav-link">News</a>
</nav>
<script>
document.querySelectorAll('.nav-dropdown > .nav-link').forEach(function(btn) {
  btn.addEventListener('click', function(e) {
    e.stopPropagation();
    var dd = btn.parentElement;
    var wasOpen = dd.classList.contains('open');
    document.querySelectorAll('.nav-dropdown.open').forEach(function(d) { d.classList.remove('open'); });
    if (!wasOpen) dd.classList.add('open');
  });
});
document.addEventListener('click', function() {
  document.querySelectorAll('.nav-dropdown.open').forEach(function(d) { d.classList.remove('open'); });
});
</script>

<div class="page-header">
  <h1>Project Overview</h1>
</div>

<main>
<div class="doc-controls">
  <button id="toggle-sections">Expand all</button>
</div>
<div class="md-body">
<h1>Judicialização da Saúde no Brasil</h1>
<p>Research project studying the efficiency and equity of judicially mandated health spending in Brazil, using random judge assignment at TJSP as an instrument for municipal health expenditure shocks.</p>
<p><strong>Paper:</strong> &quot;When Courts Allocate: Judicial Mandates, Budget Composition, and Health&quot;
<strong>Authors:</strong> Daniela Soto and Henrik Sigstad (BI Norwegian Business School)</p>
<h2 id="repository-structure">Repository structure</h2>
<pre><code>paper/                  Manuscript
  main.tex              Paper source (LaTeX, biblatex/biber)
  references.bib        Bibliography
  figures/              Paper figures

docs/                   Project documentation
  summary.md            Project overview and design choices
  institutions.md       Institutional background (SUS, courts, litigation process)
  data.md               Data sources, coverage, variables, quality notes
  methods.md            Identification strategy, estimands, assumptions
  literature.md         Literature review (8 strands)
  theory.md             Competing theoretical frameworks and testable predictions
  hypotheses.md         Theory-evidence scorecard
  qa.md                 Research Q&amp;A from NotebookLM sessions
  decisions.md          Key project decisions
  thinking.md           Open questions and speculative ideas
  todos.md              Task list
  meetings.md           Meeting records
  feedback.md           External feedback

source/                 All code
  scrape/               Data scrapers (DataJud API, TJSP, Planalto, SaudeLegis)
  clean/                Data cleaning and extraction pipelines
  summary/              Dataset statistics and registry
  site/                 Static data portal generator
  notebooklm/           NotebookLM document pipeline
  util/                 Shared library code

build/                  Generated output (gitignored)
  clean/                Cleaned CSVs (DataJud, legislation)
  summary/              Per-dataset statistics JSON
  site/                 Static HTML data portal
  notebooklm/           NotebookLM documents
  logs/                 Processing logs

data/                   Raw and processed data (gitignored)
  tjsp/                 TJSP case data (sentenças, acórdãos, consulta/)
  datajud/              DataJud API responses (JSONL)
  stf_stj/              Superior court case extracts
  trf3/                 Federal regional court case extracts
  tce_sp/               TCE-SP municipal expenditure (zipped CSVs)
  planalto/             Federal legislation (SQLite)
  saudelegis/           Health legislation (SQLite)
  tpu/                  CNJ unified subject taxonomy

references/             External reference documents (tracked)
  stf_teses/            STF binding theses and TJSP health guides
  cnj_normas/           CNJ reports and studies
  cnj_resolucoes/       CNJ resolutions
  cnj_enunciados/       Health law enunciados
  sus_financiamento/    SUS financing documents
  audesp/               TCE-SP Audesp manuals
  legislacao_processual/ Procedural law references
  sinteses/             Synthesized reference documents
  ...                   Other PDFs, CSVs, and catalogs
</code></pre>
<h2 id="data-sources">Data sources</h2>
<table>
<thead>
<tr>
  <th>Source</th>
  <th>Description</th>
  <th>Coverage</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>TJSP</strong></td>
  <td>First-instance health decisions (sentenças and acórdãos)</td>
  <td>São Paulo state, 2005–2024</td>
</tr>
<tr>
  <td><strong>DataJud</strong></td>
  <td>CNJ national case metadata API</td>
  <td>All Brazilian courts</td>
</tr>
<tr>
  <td><strong>STF/STJ</strong></td>
  <td>Superior court health jurisprudence</td>
  <td>National</td>
</tr>
<tr>
  <td><strong>TRF3</strong></td>
  <td>Federal regional court health cases</td>
  <td>São Paulo + MS</td>
</tr>
<tr>
  <td><strong>TCE-SP</strong></td>
  <td>Municipal expenditure line items (Audesp)</td>
  <td>644 SP municipalities, 2008–2024</td>
</tr>
<tr>
  <td><strong>SIH/SUS</strong></td>
  <td>Individual hospitalization records (microdata)</td>
  <td>National, ~2000–present</td>
</tr>
<tr>
  <td><strong>SIM</strong></td>
  <td>Individual mortality records (microdata)</td>
  <td>National, ~2000–present</td>
</tr>
<tr>
  <td><strong>SINASC</strong></td>
  <td>Live birth records</td>
  <td>National</td>
</tr>
<tr>
  <td><strong>RAIS</strong></td>
  <td>Formal employment records (individual)</td>
  <td>National</td>
</tr>
<tr>
  <td><strong>Name registry</strong></td>
  <td>Complete Brazilian name registry (~50% unique)</td>
  <td>National</td>
</tr>
</tbody>
</table>
<p>See <code>docs/data.md</code> for detailed variable definitions, sample restrictions, and data quality notes.</p>
<h2 id="building">Building</h2>
<pre><code class="language-bash">pip install -r requirements.txt
</code></pre>
<p>Build commands:</p>
<pre><code class="language-bash">bash build.sh          # compile PDF + update NotebookLM docs
bash build.sh pdf      # compile PDF only
bash build.sh notebook # update NotebookLM docs only
bash build.sh site     # build static data portal
</code></pre>
<p>The PDF is compiled via <code>latexmk</code> with <code>biber</code> for bibliography processing.</p>
<h2 id="data-pipeline">Data pipeline</h2>
<p>Scrapers write raw data to <code>data/</code>, cleaning scripts write to <code>build/clean/</code>:</p>
<pre><code class="language-bash"># Scrape (requires API keys / network access)
python -m source.scrape.datajud_saude
python -m source.scrape.tjsp_consulta_scraper
python -m source.scrape.saudelegis_scraper
# Planalto scraper moved to pipelines/bdata repo

# Clean and extract
python -m source.clean.normalize_jsonl data/datajud/saude_tjsp.jsonl
python -m source.clean.extract_tjsp_sentencas_health_all
python -m source.clean.collapse_tjsp_sentencas
python -m source.clean.extract_health_laws

# Summarize and build portal
python -m source.summary.build_all
python -m source.site.build_all
</code></pre>

</div>
</main>

<footer>
  Generated by <code>bash build.sh site</code>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const body = document.querySelector('.md-body');
  if (!body) return;

  function foldHeadings(container, tag) {
    const level = tag.replace('H', '');
    const headings = Array.from(container.querySelectorAll(':scope > ' + tag.toLowerCase()));
    headings.forEach(h => {
      const details = document.createElement('details');
      details.className = 'level-' + level;
      if (h.id) details.id = h.id;
      const summary = document.createElement('summary');
      summary.innerHTML = h.innerHTML;
      details.appendChild(summary);
      let sibling = h.nextElementSibling;
      const collected = [];
      while (sibling && sibling.tagName !== tag) {
        collected.push(sibling);
        sibling = sibling.nextElementSibling;
      }
      collected.forEach(el => details.appendChild(el));
      h.replaceWith(details);
    });
    return headings.length;
  }

  // Fold h2 sections, then h3 sections within each h2
  const count = foldHeadings(body, 'H2');
  if (count === 0) {
    document.querySelector('.doc-controls').style.display = 'none';
    return;
  }
  body.querySelectorAll('details.level-2').forEach(d => foldHeadings(d, 'H3'));

  // Toggle button
  const btn = document.getElementById('toggle-sections');
  if (!btn) return;
  btn.addEventListener('click', () => {
    const allDetails = body.querySelectorAll('details');
    const expanding = btn.textContent === 'Expand all';
    allDetails.forEach(d => d.open = expanding);
    btn.textContent = expanding ? 'Collapse all' : 'Expand all';
  });

  // Auto-open details when navigating to an anchor
  function openAnchorTarget() {
    if (!location.hash) return;
    const target = document.querySelector(location.hash);
    if (!target) return;
    let el = target;
    while (el) {
      if (el.tagName === 'DETAILS') el.open = true;
      el = el.parentElement;
    }
    target.scrollIntoView();
  }
  openAnchorTarget();
  window.addEventListener('hashchange', openAnchorTarget);
});
</script>

</body>
</html>
