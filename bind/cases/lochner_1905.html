<!DOCTYPE html>
<html lang="en">
<head>
<meta name="robots" content="noindex, nofollow">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Lochner v. New York â€” The Binding Force of Law</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css">
<style>
  :root {
    --bg: #f8f9fa; --card: #fff; --fg: #1a1a1a; --muted: #666;
    --border: #dee2e6; --accent: #0d6efd; --accent2: #198754;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background: var(--bg); color: var(--fg); line-height: 1.5;
  }

  main {
    padding: 1.5rem 2rem 3rem; max-width: 900px; margin: 0 auto;
  }

  /* Markdown body styles */
  .md-body { font-size: .92rem; line-height: 1.7; color: #1f2328; }

  .md-body h1 { font-size: 1.5rem; font-weight: 600; margin: 1.8rem 0 .8rem; padding-bottom: .3rem; border-bottom: 1px solid var(--border); }
  .md-body h2 { font-size: 1.25rem; font-weight: 600; margin: 1.6rem 0 .6rem; padding-bottom: .25rem; border-bottom: 1px solid var(--border); }
  .md-body h3 { font-size: 1.05rem; font-weight: 600; margin: 1.3rem 0 .5rem; }
  .md-body h4 { font-size: .95rem; font-weight: 600; margin: 1.1rem 0 .4rem; }
  .md-body h5, .md-body h6 { font-size: .88rem; font-weight: 600; margin: 1rem 0 .4rem; }
  .md-body h1:first-child { margin-top: 0; }

  .md-body p { margin: 0 0 .8rem; }

  .md-body ul, .md-body ol { margin: 0 0 .8rem; padding-left: 1.8rem; }
  .md-body li { margin-bottom: .25rem; }
  .md-body li > ul, .md-body li > ol { margin-top: .25rem; margin-bottom: 0; }

  /* Task lists */
  .md-body ul li { list-style: disc; }
  .md-body li input[type="checkbox"] {
    margin-right: .4rem; vertical-align: middle; position: relative; top: -1px;
  }

  .md-body a { color: var(--accent); text-decoration: none; }
  .md-body a:hover { text-decoration: underline; }

  .md-body strong { font-weight: 600; }

  .md-body blockquote {
    margin: 0 0 .8rem; padding: .4rem 1rem;
    border-left: 4px solid var(--accent); background: #f0f4f8;
    color: #555; font-size: .88rem;
  }
  .md-body blockquote p:last-child { margin-bottom: 0; }

  .md-body code {
    font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
    font-size: .85em; background: #eef1f5; padding: .15rem .35rem;
    border-radius: 4px;
  }
  .md-body pre {
    margin: 0 0 .8rem; padding: .9rem 1rem;
    background: #f6f8fa; border: 1px solid var(--border);
    border-radius: 6px; overflow-x: auto; line-height: 1.45;
  }
  .md-body pre code {
    background: none; padding: 0; font-size: .82rem;
  }

  .md-body table {
    width: 100%; border-collapse: collapse; margin: 0 0 .8rem;
    font-size: .85rem; display: block; overflow-x: auto;
  }
  .md-body th, .md-body td {
    padding: .45rem .7rem; border: 1px solid var(--border); text-align: left;
  }
  .md-body th { background: #f0f4f8; font-weight: 600; }
  .md-body tr:nth-child(even) td { background: #fafbfc; }

  .md-body hr {
    border: none; border-top: 1px solid var(--border); margin: 1.5rem 0;
  }

  .md-body img { max-width: 100%; }

  /* Collapsible sections */
  .doc-controls { margin-bottom: 1rem; }
  .doc-controls button {
    font-size: .8rem; padding: .3rem .7rem; cursor: pointer;
    background: var(--card); border: 1px solid var(--border); border-radius: 4px;
    color: var(--accent); font-weight: 600;
  }
  .doc-controls button:hover { background: #e7f1ff; }
  .md-body details { margin-bottom: .5rem; }
  .md-body details summary {
    font-weight: 600; cursor: pointer; list-style: none;
  }
  .md-body details summary::-webkit-details-marker { display: none; }
  .md-body details summary::before {
    content: "\25b6"; font-size: .7em; margin-right: .5rem;
    display: inline-block; transition: transform .15s;
  }
  .md-body details[open] summary::before { transform: rotate(90deg); }
  .md-body details.level-2 > summary {
    font-size: 1.25rem; padding-bottom: .25rem;
    border-bottom: 1px solid var(--border); margin: 1.6rem 0 .6rem;
  }
  .md-body details.level-3 > summary {
    font-size: 1.05rem; margin: 1.3rem 0 .5rem;
  }

  footer {
    text-align: center; padding: 1.5rem; font-size: .8rem; color: var(--muted);
    border-top: 1px solid var(--border); margin-top: 2rem;
  }
</style>
</head>
<body>

<style>
  .site-nav {
    position: sticky; top: 0; z-index: 100;
    background: #212529; display: flex; align-items: center;
    padding: 0 2rem; height: 3rem;
  }
  .site-nav .nav-brand {
    color: #fff; text-decoration: none; font-weight: 600; font-size: 1rem;
    margin-right: auto;
  }
  .site-nav .nav-brand:hover { color: #e9ecef; }
  .site-nav .nav-link {
    color: #adb5bd; text-decoration: none; font-size: .85rem;
    padding: 0 .75rem; height: 3rem; display: flex; align-items: center;
    background: none; border: none; cursor: pointer; font-family: inherit;
  }
  .site-nav .nav-link:hover, .site-nav .nav-link.active { color: #fff; }
  .nav-dropdown { position: relative; }
  .dropdown-menu {
    display: none; position: absolute; top: 3rem; right: 0;
    background: #fff; border: 1px solid var(--border); border-radius: 6px;
    box-shadow: 0 4px 16px rgba(0,0,0,.12); min-width: 220px;
    padding: .4rem 0; z-index: 200; max-height: 80vh; overflow-y: auto;
  }
  .nav-dropdown.open .dropdown-menu { display: block; }
  .dropdown-menu a {
    display: block; padding: .3rem 1rem; color: #1a1a1a;
    text-decoration: none; font-size: .82rem;
  }
  .dropdown-menu a:hover { background: #f0f4f8; }
  .dropdown-group-label {
    padding: .4rem 1rem .15rem; font-size: .68rem; font-weight: 700;
    color: #888; text-transform: uppercase; letter-spacing: .04em;
  }
  .dropdown-divider { border-top: 1px solid #eee; margin: .3rem 0; }
  .page-header {
    padding: .8rem 2rem; border-bottom: 1px solid var(--border); background: #fff;
  }
  .page-header h1 { font-size: 1.3rem; font-weight: 600; }
  .page-header p { color: var(--muted); font-size: .85rem; margin-top: .15rem; }
</style>

<nav class="site-nav">
  <a href="../index.html" class="nav-brand">The Binding Force of Law</a>
  <a href="../index.html" class="nav-link">Home</a>
  <a href="../paper/index.html" class="nav-link">Paper</a>
  <div class="nav-dropdown">
    <button class="nav-link">Docs &#9662;</button>
    <div class="dropdown-menu">
    <div class="dropdown-group-label">Reference</div>
    <a href="../docs/summary.html">Research Summary</a>
    <a href="../docs/institutions.html">Institutional Background</a>
    <a href="../docs/data.html">Data & Extractions</a>
    <a href="../docs/methods.html">Formal Model</a>
    <a href="../docs/literature.html">Literature</a>
    <div class="dropdown-divider"></div>
    <div class="dropdown-group-label">Working notes</div>
    <a href="../docs/thinking.html">Open Questions & Ideas</a>
    <a href="../docs/decisions.html">Key Decisions</a>
    <div class="dropdown-divider"></div>
    <div class="dropdown-group-label">Tasks</div>
    <a href="../docs/todo.html">Active Tasks</a>
    <a href="../docs/done.html">Completed Tasks</a>
    <div class="dropdown-divider"></div>
    <div class="dropdown-group-label">Communication</div>
    <a href="../docs/meetings.html">Meeting Notes</a>
    <a href="../docs/feedback.html">External Feedback</a>
    </div>
  </div>
  <div class="nav-dropdown">
    <button class="nav-link">Briefs &#9662;</button>
    <div class="dropdown-menu">
    <a href="../briefs/holding-formalization.html">Decision brief: How to formalize holdings</a>
    <a href="../briefs/paper-status.html">Decision brief: Paper status and path to submission</a>
    </div>
  </div>
  <div class="nav-dropdown">
    <button class="nav-link active">Cases &#9662;</button>
    <div class="dropdown-menu">
    <div class="dropdown-group-label">Equal Protection</div>
    <a href="../cases/carolene_products_1938.html">United States v. Carolene Products Co.</a>
    <a href="../cases/korematsu_1944.html">Korematsu v. United States</a>
    <a href="../cases/brown_v_board_1954.html">Brown v. Board of Education</a>
    <a href="../cases/loving_v_virginia_1967.html">Loving v. Virginia</a>
    <a href="../cases/reed_v_reed_1971.html">Reed v. Reed</a>
    <a href="../cases/craig_v_boren_1976.html">Craig v. Boren</a>
    <a href="../cases/washington_v_davis_1976.html">Washington v. Davis</a>
    <a href="../cases/arlington_heights_1977.html">Village of Arlington Heights v. Metropolitan Housing Development Corp.</a>
    <a href="../cases/feeney_1979.html">Personnel Administrator of Massachusetts v. Feeney</a>
    <a href="../cases/cleburne_1985.html">City of Cleburne v. Cleburne Living Center, Inc.</a>
    <a href="../cases/adarand_1995.html">Adarand Constructors, Inc. v. Pena</a>
    <a href="../cases/romer_v_evans_1996.html">Romer v. Evans</a>
    <a href="../cases/us_v_virginia_vmi_1996.html">United States v. Virginia</a>
    <a href="../cases/grutter_2003.html">Grutter v. Bollinger</a>
    <a href="../cases/parents_involved_2007.html">Parents Involved in Community Schools v. Seattle School District No. 1</a>
    <a href="../cases/fisher_i_2013.html">Fisher v. University of Texas at Austin</a>
    <a href="../cases/fisher_ii_2016.html">Fisher v. University of Texas at Austin</a>
    <a href="../cases/sffa_2023.html">Students for Fair Admissions, Inc. v. President and Fellows of Harvard College</a>
    <div class="dropdown-divider"></div>
    <div class="dropdown-group-label">Due Process</div>
    <a href="../cases/lochner_1905.html">Lochner v. New York</a>
    <a href="../cases/griswold_1965.html">Griswold v. Connecticut</a>
    <a href="../cases/roe_v_wade_1973.html">Roe v. Wade</a>
    <a href="../cases/mathews_v_eldridge_1976.html">Mathews v. Eldridge</a>
    <a href="../cases/casey_1992.html">Planned Parenthood of Southeastern Pennsylvania v. Casey</a>
    <a href="../cases/glucksberg_1997.html">Washington v. Glucksberg</a>
    <a href="../cases/dobbs_2022.html">Dobbs v. Jackson Women's Health Organization</a>
    </div>
  </div>
</nav>
<script>
document.querySelectorAll('.nav-dropdown > .nav-link').forEach(function(btn) {
  btn.addEventListener('click', function(e) {
    e.stopPropagation();
    var dd = btn.parentElement;
    var wasOpen = dd.classList.contains('open');
    document.querySelectorAll('.nav-dropdown.open').forEach(function(d) { d.classList.remove('open'); });
    if (!wasOpen) dd.classList.add('open');
  });
});
document.addEventListener('click', function() {
  document.querySelectorAll('.nav-dropdown.open').forEach(function(d) { d.classList.remove('open'); });
});
</script>

<div class="page-header">
  <h1>Lochner v. New York</h1>
</div>

<main>
<div class="doc-controls">
  <button id="toggle-sections">Expand all</button>
</div>
<div class="md-body">
<h1>Lochner v. New York, 198 U.S. 45 (1905)</h1>
<p><strong>Author:</strong> Peckham (majority)
<strong>Outcome:</strong> Plaintiff wins ($d = 1$: state law invalidated under DP)
<strong>Concurrences:</strong> None
<strong>Dissents:</strong> Harlan, White, Day, Holmes</p>
<hr />
<h2 id="1-holding-h-t">1. Holding ($H_t$)</h2>
<blockquote>
<p>&quot;The statute necessarily interferes with the right of contract between the employer and employes, concerning the number of hours in which the latter may labor in the bakery of the employer. The general right to make a contract in relation to his business is part of the liberty of the individual protected by the Fourteenth Amendment of the Federal Constitution.&quot; (p. 53)</p>
</blockquote>
<blockquote>
<p>&quot;There is no reasonable ground for interfering with the liberty of person or the right of free contract, by determining the hours of labor, in the occupation of a baker.&quot; (p. 57)</p>
</blockquote>
<p><strong>As constraint on admissible $(w, c)$:</strong> Rules out any decision rule under which state-imposed restrictions on the number of hours bakers can work are constitutional, absent a clear and direct relation to public health or safety. The weight on liberty of contract must be large enough to invalidate such restrictions unless they meet a stringent necessity test.</p>
<p><strong>What the holding does NOT constrain:</strong></p>
<ul>
<li>Whether similar restrictions in other occupations might be justified</li>
<li>The validity of other health and safety regulations not directly limiting hours</li>
<li>The scope of state police powers in contexts with clearer health implications</li>
<li>The application of the police power to emergency situations</li>
</ul>
<hr />
<h2 id="2-fact-vector-z-t">2. Fact vector $z_t$</h2>
<h3 id="2a-raw-salient-facts">2a. Raw salient facts</h3>
<ul>
<li><strong>Liberty of contract:</strong> &quot;The general right to make a contract in relation to his business is part of the liberty of the individual protected by the Fourteenth Amendment&quot; (p. 53). Favors: plaintiff.</li>
<li><strong>Baker's occupation not unhealthy:</strong> &quot;We think that there can be no fair doubt that the trade of a baker, in and of itself, is not an unhealthy one to that degree which would authorize the legislature to interfere&quot; (p. 59). Favors: plaintiff.</li>
<li><strong>Lack of emergency clause:</strong> &quot;The statute now before this court has no emergency clause in it&quot; (p. 58). Favors: plaintiff.</li>
<li><strong>Existing health regulations:</strong> &quot;These various sections may be wise and valid regulations, and they certainly go to the full extent of providing for the cleanliness and the healthiness&quot; (p. 68). Favors: plaintiff.</li>
<li><strong>Police power limits:</strong> &quot;There is, in our judgment, no reasonable foundation for holding this to be necessary or appropriate as a health law&quot; (p. 62). Favors: plaintiff.</li>
<li><strong>State's justification inadequate:</strong> &quot;The mere assertion that the subject relates though but in a remote degree to the public health does not necessarily render the enactment valid&quot; (p. 61). Favors: plaintiff.</li>
</ul>
<h3 id="2b-dimension-mapping">2b. Dimension mapping</h3>
<table>
<thead>
<tr>
  <th>Dimension</th>
  <th>Value</th>
  <th>Raw fact(s) mapped</th>
  <th>Textual basis</th>
</tr>
</thead>
<tbody>
<tr>
  <td>D1 Liberty interest type</td>
  <td>Economic</td>
  <td>Liberty of contract</td>
  <td>&quot;The general right to make a contract in relation to his business&quot; (p. 53)</td>
</tr>
<tr>
  <td>D2 Historical grounding</td>
  <td>High</td>
  <td>Liberty of contract; police power limits</td>
  <td>&quot;The general right to make a contract... is part of the liberty... protected by the Fourteenth Amendment&quot; (p. 53)</td>
</tr>
<tr>
  <td>D3 Level of generality</td>
  <td>Narrow</td>
  <td>Baker's occupation not unhealthy</td>
  <td>&quot;We think that there can be no fair doubt that the trade of a baker... is not an unhealthy one&quot; (p. 59)</td>
</tr>
<tr>
  <td>D4 Government interest strength</td>
  <td>Weak</td>
  <td>State's justification inadequate</td>
  <td>&quot;There is, in our judgment, no reasonable foundation for holding this to be necessary or appropriate as a health law&quot; (p. 62)</td>
</tr>
<tr>
  <td>D5 Intrusion severity</td>
  <td>High</td>
  <td>Liberty of contract; lack of emergency clause</td>
  <td>&quot;The statute necessarily interferes with the right of contract&quot; (p. 53)</td>
</tr>
<tr>
  <td>D6 Methodology</td>
  <td>Autonomy-based</td>
  <td>Liberty of contract; police power limits</td>
  <td>&quot;The general right to make a contract... is part of the liberty... protected by the Fourteenth Amendment&quot; (p. 53)</td>
</tr>
<tr>
  <td>D7 Institutional setting</td>
  <td>Economic regulation</td>
  <td>Existing health regulations</td>
  <td>&quot;These various sections may be wise and valid regulations&quot; (p. 68)</td>
</tr>
<tr>
  <td>D8 Precedent density</td>
  <td>High conflict</td>
  <td>Police power limits; state's justification inadequate</td>
  <td>&quot;There is, in our judgment, no reasonable foundation for holding this to be necessary or appropriate as a health law&quot; (p. 62)</td>
</tr>
</tbody>
</table>
<p><strong>Unmapped facts:</strong></p>
<ul>
<li><em>Lack of emergency clause</em> does not map directly to any dimension but highlights the absence of a compelling state interest or exigency that might justify the regulation.</li>
</ul>
<p><strong>Notable:</strong> The Court emphasizes the autonomy-based methodology, focusing on the liberty of contract as a fundamental right protected by the Fourteenth Amendment, and sets a high bar for state interference under the guise of police power.</p>
<hr />
<h2 id="3-treatment-of-prior-holdings-mathcal-f-t-update">3. Treatment of prior holdings ($\mathcal{F}_t$ update)</h2>
<h3 id="holden-v-hardy-1898">Holden v. Hardy (1898)</h3>
<ul>
<li><strong>Status:</strong> Distinguished. The Court notes that Holden involved mining and smelting, which were inherently dangerous occupations, unlike baking.</li>
<li><strong>Characterization:</strong> The Court acknowledges Holden as a valid exercise of police power due to the specific dangers of the occupations involved.</li>
<li><strong>Model interpretation:</strong> The Court limits Holden to contexts with clear health or safety risks, maintaining a narrower feasible set for state regulation under the police power.</li>
</ul>
<h3 id="jacobson-v-massachusetts-1905">Jacobson v. Massachusetts (1905)</h3>
<ul>
<li><strong>Status:</strong> Distinguished. The Court notes that Jacobson involved compulsory vaccination, a clear public health measure.</li>
<li><strong>Characterization:</strong> The Court views Jacobson as addressing a direct threat to public health, unlike the regulation of bakers' hours.</li>
<li><strong>Model interpretation:</strong> The Court maintains that Jacobson supports state action only when there is a direct and substantial relation to public health.</li>
</ul>
<h3 id="mugler-v-kansas-1887">Mugler v. Kansas (1887)</h3>
<ul>
<li><strong>Status:</strong> Relied on. The Court cites Mugler for the principle that state police powers are limited to reasonable regulations.</li>
<li><strong>Characterization:</strong> The Court uses Mugler to support the idea that police power cannot justify arbitrary interference with individual rights.</li>
<li><strong>Model interpretation:</strong> The Court reinforces the constraint that police power must have a clear and direct relation to public health or safety.</li>
</ul>
<hr />
<h2 id="4-overruling-constraint-removal-at-cost-c">4. Overruling (constraint removal at cost $C$)</h2>
<p><strong>What is removed:</strong> The constraint that allowed state regulation of work hours in the baking industry under the guise of health regulation without clear evidence of necessity.</p>
<p><strong>Justification (mapping to stare decisis factors):</strong></p>
<ul>
<li><em>Quality of reasoning:</em> The Court finds no reasonable foundation for the health justification, viewing the regulation as arbitrary.</li>
<li><em>Workability:</em> The Court implies that allowing such regulations would lead to limitless state interference in economic matters.</li>
<li><em>Consistency with related doctrine:</em> The decision aligns with previous rulings emphasizing the limits of police power.</li>
<li><em>Reliance interests:</em> Not explicitly addressed, but the decision suggests a preference for protecting established economic liberties.</li>
</ul>
<p><strong>Institutional cost:</strong> The decision signals a high threshold for state interference in economic liberties, potentially limiting future regulatory efforts.</p>
<hr />
<h2 id="5-breadth">5. Breadth</h2>
<p><strong>Narrow reading (what the Court explicitly holds):</strong></p>
<ul>
<li>State-imposed limits on working hours in the baking industry are invalid without clear evidence of health necessity.</li>
<li>Emphasizes the protection of liberty of contract under the Fourteenth Amendment.</li>
</ul>
<p><strong>Broad reading (what the reasoning supports):</strong></p>
<ul>
<li>The decision could be read to limit state regulation of working conditions across various industries unless a direct health or safety justification is provided.</li>
<li>Suggests a broader protection for economic liberties against state interference.</li>
</ul>
<p><strong>Breadth ambiguity:</strong>
The opinion leaves open the possibility of state regulation in other contexts with clearer health or safety justifications, creating ambiguity about the scope of permissible state action under the police power.</p>
<hr />
<h2 id="6-concurrences-dissents-alternative-admissible-theories">6. Concurrences / dissents (alternative admissible theories)</h2>
<h3 id="harlan-white-and-day-dissenting">Harlan, White, and Day (dissenting)</h3>
<ul>
<li><strong>Alternative constraint structure:</strong> Would uphold the state law as a valid exercise of police power, emphasizing the state's role in protecting public health.</li>
<li><strong>Key disagreement:</strong> Disagree with the majority's assessment of the health risks associated with baking and the limits of state police power.</li>
</ul>
<h3 id="holmes-dissenting">Holmes (dissenting)</h3>
<ul>
<li><strong>Alternative constraint structure:</strong> Argues for judicial restraint and deference to state legislative judgments, emphasizing the diversity of economic theories.</li>
<li><strong>Key disagreement:</strong> Criticizes the majority for imposing its economic theory over legislative judgment, advocating for a broader interpretation of state police powers.</li>
</ul>
<hr />
<h2 id="7-reasoning-revealing-implicit-weights-on-dimensions">7. Reasoning revealing implicit weights on dimensions</h2>
<p><strong>Liberty of contract as a fundamental right (D1, D6 weight is high):</strong></p>
<blockquote>
<p>&quot;The general right to make a contract in relation to his business is part of the liberty of the individual protected by the Fourteenth Amendment&quot; (p. 53)</p>
</blockquote>
<p>The Court places significant weight on the autonomy-based methodology, prioritizing individual economic liberties over state regulatory interests.</p>
<p><strong>Skepticism of health justification (D4 weight is low):</strong></p>
<blockquote>
<p>&quot;There is, in our judgment, no reasonable foundation for holding this to be necessary or appropriate as a health law&quot; (p. 62)</p>
</blockquote>
<p>The Court expresses skepticism about the state's health justification, indicating a low weight on the government's interest strength in this context.</p>
<p><strong>Limits on police power (D8 weight is high):</strong></p>
<blockquote>
<p>&quot;The mere assertion that the subject relates though but in a remote degree to the public health does not necessarily render the enactment valid&quot; (p. 61)</p>
</blockquote>
<p>The Court emphasizes the need for a direct and substantial relation to public health, reinforcing a high threshold for state action under the police power.</p>

</div>
</main>

<footer>
  Generated by <code>python3 -m source.site.build_all</code>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const body = document.querySelector('.md-body');
  if (!body) return;

  function foldHeadings(container, tag) {
    const level = tag.replace('H', '');
    const headings = Array.from(container.querySelectorAll(':scope > ' + tag.toLowerCase()));
    headings.forEach(h => {
      const details = document.createElement('details');
      details.className = 'level-' + level;
      if (h.id) details.id = h.id;
      const summary = document.createElement('summary');
      summary.innerHTML = h.innerHTML;
      details.appendChild(summary);
      let sibling = h.nextElementSibling;
      const collected = [];
      while (sibling && sibling.tagName !== tag) {
        collected.push(sibling);
        sibling = sibling.nextElementSibling;
      }
      collected.forEach(el => details.appendChild(el));
      h.replaceWith(details);
    });
    return headings.length;
  }

  // Fold h2 sections, then h3 sections within each h2
  const count = foldHeadings(body, 'H2');
  if (count === 0) {
    document.querySelector('.doc-controls').style.display = 'none';
    return;
  }
  body.querySelectorAll('details.level-2').forEach(d => foldHeadings(d, 'H3'));

  // Toggle button
  const btn = document.getElementById('toggle-sections');
  if (!btn) return;
  btn.addEventListener('click', () => {
    const allDetails = body.querySelectorAll('details');
    const expanding = btn.textContent === 'Expand all';
    allDetails.forEach(d => d.open = expanding);
    btn.textContent = expanding ? 'Collapse all' : 'Expand all';
  });

  // Auto-open details when navigating to an anchor
  function openAnchorTarget() {
    if (!location.hash) return;
    const target = document.querySelector(location.hash);
    if (!target) return;
    let el = target;
    while (el) {
      if (el.tagName === 'DETAILS') el.open = true;
      el = el.parentElement;
    }
    target.scrollIntoView();
  }
  openAnchorTarget();
  window.addEventListener('hashchange', openAnchorTarget);
});
</script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js"
  onload="renderMathInElement(document.querySelector('.md-body'), {
    delimiters: [
      {left: '$$', right: '$$', display: true},
      {left: '$', right: '$', display: false}
    ],
    throwOnError: false
  });"></script>
</body>
</html>
